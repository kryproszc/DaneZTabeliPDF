> ### TESTY
> # Sprawdzenie liczby unikalnych `REGON` w obu zbiorach danych
> cat("Unikalne REGON w gminy:", length(unique(gminy$REGON)), "\n")
Unikalne REGON w gminy: 2247 
> cat("Unikalne REGON w wynik_gminy_df:", length(unique(wynik_gminy_df$REGON)), "\n")
Unikalne REGON w wynik_gminy_df: 1687 
> # Sprawdzenie, które `REGON` w `gminy` nie mają odpowiedników w `wynik_gminy_df`
> missing_REGON <- setdiff(gminy$REGON, wynik_gminy_df$REGON)
> cat("Liczba brakujących REGON w wynik_gminy_df:", length(missing_REGON), "\n")
Liczba brakujących REGON w wynik_gminy_df: 561 
> print(missing_REGON)
  [1] "11019785900000" "67022372900000" "15139857000000" "13037808300000" "67022403100000" "39064751200000" "09235095500000" "37044005700000" "59064792500000"
 [10] "13037806000000" "55066784700000" "89071829000000" "15139867500000" "45066979500000" "93193514100000" "89071843200000" "73093447600000" "77097971400000"
 [19] "05065926600000" "79067123100000" "23082157500000" "23082143400000" "81168534900000" "23082172400000" "31101911900000" "87111880400000" "87111881000000"
 [28] "91086681500000" "95036915500000" "97077022100000" "95036879900000" "97077031000000" "53141313600000" "05065901300000" "05065967400000" "45066977200000"
 [37] "33092059300000" "09235096100000" "55066782400000" "15139851100000" "19167563000000" "23082134500000" "51074401300000" "95036881300000" "23082159800000"
 [46] "37044004000000" "61101580400000" "39064737000000" "25085553500000" "25085555800000" "15139830400000" "27625894800000" "71158237400000" "39064734000000"
 [55] "37044059000000" "18051533900000" "45067030900000" "29101052400000" "57079124700000" "67022396500000" "55066812000000" "57079110600000" "25085515600000"
 [64] "37044022900000" "37044020600000" "19167504300000" "73093467700000" "01589122000000" "65090044700000" "45067023200000" "63125930100000" "97077041600000"
 [73] "29101008500000" "77097982600000" "55066830900000" "23082170100000" "11019788800000" "91086675500000" "59064791900000" "65090064800000" "13037805400000"
 [82] "37044000500000" "45066976600000" "21096670500000" "85166075000000" "45066978900000" "05065941500000" "05065927200000" "75014848900000" "71158256900000"
 [91] "85166078900000" "61101590000000" "71158205500000" "71158203200000" "41105065200000" "23082156900000" "87111875000000" "45067011400000" "13037826100000"
[100] "69058196200000" "93193477900000" "91086684400000" "75014828800000" "61101537100000" "13037807700000" "05065922000000" "73093464800000" "15139866900000"
[109] "65090047600000" "93193509800000" "33092051200000" "27625874700000" "71158209000000" "21096673400000" "75014829400000" "71158266400000" "77097967700000"
[118] "45066995000000" "05065957900000" "05065943800000" "05065907100000" "15139898800000" "27625837400000" "85166109100000" "35155549900000" "29101071900000"
[127] "25085520000000" "63125939900000" "71158216700000" "77097969000000" "31101917700000" "31101930300000" "37044057700000" "65090041800000" "79067133700000"
[136] "51074330900000" "57079115800000" "25085544600000" "63125852000000" "35155565400000" "79067091200000" "91086643600000" "55066840400000" "75014857800000"
[145] "29101057600000" "35155602700000" "91086665000000" "95036852300000" "85166090900000" "91086666600000" "13037844000000" "85166098000000" "39064747500000"
[154] "23082146300000" "09235102100000" "97077065200000" "97077067500000" "59064808900000" "67022397100000" "65090066000000" "93193513500000" "15139815500000"
[163] "13037836700000" "45066988400000" "45067000200000" "89071822500000" "97077076400000" "97077044500000" "59064803700000" "67022369800000" "85166083200000"
[172] "97077042200000" "79067110700000" "75014821300000" "95036895400000" "65090054200000" "95036912600000" "97077020900000" "21096686900000" "21096682300000"
[181] "61101568400000" "37044076100000" "11019797700000" "61101602800000" "87111852000000" "77097987800000" "95037168900000" "83040960800000" "73093471400000"
[190] "09235064200000" "87111857200000" "89071841000000" "71158222700000" "73093445300000" "75014833100000" "75014853200000" "05065945000000" "79067096400000"
[199] "05065923700000" "79067099300000" "45067002500000" "89071851500000" "95036874700000" "55066822600000" "29100995200000" "83040981500000" "31101904200000"
[208] "71158210900000" "29101002700000" "71158221000000" "67022402500000" "13037809000000" "35155630000000" "39064767600000" "37044073200000" "17074800500000"
[217] "17074806300000" "17074807000000" "57079139400000" "79067089800000" "71158250000000" "71158251700000" "19167502000000" "39064739200000" "13037814300000"
[226] "67022350500000" "49189271300000" "67022379300000" "83040943600000" "97077066900000" "55066817200000" "53141292900000" "37044006300000" "45066973700000"
[235] "97077055700000" "59064786500000" "73093436400000" "73093439300000" "53141321900000" "43101987900000" "97077085300000" "75014859000000" "67022401900000"
[244] "89071788100000" "03023755200000" "43102000300000" "55066789900000" "69058198500000" "75014785700000" "95036882000000" "13037804800000" "59064826700000"
[253] "71158235100000" "59064819000000" "89071845500000" "71158232200000" "27625847000000" "31101934900000" "65090037000000" "79067101800000" "23082161200000"
[262] "23082153000000" "89071812000000" "97077021500000" "97077081800000" "79067125400000" "67022368100000" "41105054000000" "15139847400000" "15139841600000"
[271] "69058169500000" "67022391300000" "29101070200000" "81168527200000" "25085538600000" "63125825300000" "31101948000000" "17074786200000" "13037846200000"
[280] "67022392000000" "83040946500000" "85166099600000" "23082148600000" "09235098400000" "59064827300000" "05065955600000" "15139858600000" "05065905900000"
[289] "05065929500000" "21096696400000" "15139868100000" "71158252300000" "75014830200000" "61101588500000" "71158230000000" "69058195600000" "93193499200000"
[298] "93193475600000" "25085504400000" "25085488900000" "91086680900000" "75014788600000" "75014841400000" "69058213400000" "61101579600000" "21096677000000"
[307] "83040955400000" "83040982100000" "55066835000000" "71158273000000" "21096685200000" "03023768700000" "07218194200000" "23082168700000" "79067118800000"
[316] "79067112000000" "45066987800000" "79067115900000" "15139899400000" "51074300200000" "31101933200000" "25085502100000" "25085517900000" "25085518500000"
[325] "27625879900000" "69058168900000" "17074790000000" "75014826500000" "81168523700000" "57079145400000" "25085511000000" "75014835400000" "35155547600000"
[334] "49189253500000" "81168485800000" "37044033000000" "29101006200000" "29101064200000" "83040976100000" "83041003700000" "13037853900000" "13037845600000"
[343] "09235093200000" "45067009000000" "53141283000000" "89071836600000" "67022363000000" "13037811400000" "45066998000000" "15139808900000" "05065934900000"
[352] "59064829600000" "53141323100000" "91086644200000" "73093449900000" "73093456500000" "71158282000000" "33092060100000" "49189228000000" "39076588400000"
[361] "39064768200000" "17074794500000" "69058172600000" "41105063000000" "93193470400000" "31101953300000" "75014822000000" "47205778000000" "61101599700000"
[370] "13037813700000" "53141311300000" "83040910000000" "05065896000000" "73093462500000" "41105051100000" "03023764100000" "55066832100000" "65090033500000"
[379] "65090043000000" "39064743000000" "23082169300000" "23082171800000" "17074787900000" "81168459700000" "81168458000000" "81168433800000" "29101009100000"
[388] "13037825500000" "49189230500000" "29101082000000" "25085545200000" "31101914800000" "63125941300000" "15139837900000" "15139844500000" "15139835600000"
[397] "69058165000000" "87111867800000" "35155539300000" "75014819900000" "17074804000000" "59064799000000" "29100976800000" "51074297100000" "41105070600000"
[406] "57079108100000" "21096705300000" "25085500900000" "63125818700000" "63125822400000" "97077072900000" "85166110000000" "59064789400000" "45067021000000"
[415] "33092064700000" "97077052800000" "67022399400000" "81168596400000" "73093470800000" "61101544800000" "61101589100000" "01326920300000" "37044003400000"
[424] "05065924300000" "93193510600000" "55066813700000" "93193490500000" "15139817800000" "97077039100000" "13037852200000" "67022393600000" "75014843700000"
[433] "73093435800000" "73093443000000" "05065936100000" "91086640700000" "75014824200000" "71158206100000" "67022384700000" "13037841000000" "65090056500000"
[442] "47205775000000" "61101605700000" "91086688000000" "61101575000000" "61101550800000" "95036883600000" "21096678600000" "15139864600000" "73093472000000"
[451] "71158229100000" "83040961400000" "83040965000000" "23082150000000" "67022385300000" "13037828400000" "87111872100000" "93193503000000" "67022342200000"
[460] "71158233900000" "49189258700000" "35155505100000" "35155622800000" "23082155200000" "53141272800000" "39064763000000" "89071790600000" "01589125000000"
[469] "81168532600000" "49189268200000" "05065933200000" "73093442400000" "59064809500000" "45066989000000" "57079125300000" "55066785300000" "31101932600000"
[478] "15139829600000" "13037834400000" "13037843300000" "33092092000000" "83040972600000" "29101014500000" "17074813000000" "51074280100000" "79067154400000"
[487] "17074797400000" "63125892200000" "63125926400000" "57079117000000" "91086646500000" "59064781300000" "59064806600000" "31101919000000" "55066837300000"
[496] "85166088400000" "81168443300000" "97077062300000" "01327039900000" "83040962000000" "97077059200000" "05065910200000" "59064813200000" "85166082600000"
[505] "45067006000000" "75014823600000" "61101601100000" "29101012200000" "01327130600000" "79067120200000" "39064741700000" "03023770100000" "03023767000000"
[514] "13037816600000" "97077025000000" "61101600500000" "61101562600000" "97077029600000" "21096674000000" "59064793100000" "35155589000000" "83040967200000"
[523] "67022336200000" "63125816400000" "91086687300000" "55066788200000" "29101031700000" "03023752300000" "67022366900000" "67022352800000" "71158219600000"
[532] "71158213800000" "29101061300000" "33092072000000" "73093448200000" "37044038200000" "39076719100000" "21096695800000" "75014844300000" "71158220400000"
[541] "23082167000000" "59064805000000" "79067128300000" "57079103000000" "57079107500000" "57079127600000" "37044019800000" "45067018900000" "71158208400000"
[550] "61101566100000" "81168553300000" "49189326200000" "29101034600000" "31101927200000" "25085543000000" "27625767600000" "65090035800000" "39064758700000"
[559] "19167528000000" "33092074200000" "55066790700000"
> # Sprawdzenie, czy istnieją duplikaty REGON w `wynik_gminy_df`
> duplikaty <- wynik_gminy_df %>%
+   group_by(REGON) %>%
+   summarise(count = n()) %>%
+   filter(count > 1)
> cat("Liczba zduplikowanych REGON:", nrow(duplikaty), "\n")
Liczba zduplikowanych REGON: 0 
> print(duplikaty)
# A tibble: 0 x 2
# i 2 variables: REGON <chr>, count <int>
> gminy_z_budynkami$total_budynkow[is.na(gminy_z_budynkami$total_budynkow)] <- 0
> total_sum_after_join <- sum(gminy_z_budynkami$total_budynkow)
> cat("Suma liczby budynków po `left_join` (po zamianie NA na 0):", total_sum_after_join, "\n")
Suma liczby budynków po `left_join` (po zamianie NA na 0): 26895 
> # Użycie `inner_join` zamiast `left_join`
> gminy_z_budynkami_inner <- inner_join(gminy, wynik_gminy_df, by = "REGON")
> inner_sum <- sum(gminy_z_budynkami_inner$total_budynkow, na.rm = TRUE)
> cat("Suma liczby budynków po `inner_join`:", inner_sum, "\n")
Suma liczby budynków po `inner_join`: 26895 
