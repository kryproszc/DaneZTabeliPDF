library(openxlsx)

# Wczytanie pliku Excel
plik <- "twoj_plik.xlsx"
wb <- loadWorkbook(plik)

# Wczytanie danych z pierwszego arkusza
dane <- read.xlsx(wb, sheet = 1)

# Pobranie stylów komórek z pierwszego arkusza
style_komorek <- getStyles(wb)
arkusz <- wb$worksheets[[1]]

# Funkcja do sprawdzenia, czy wiersz zawiera przekreśloną komórkę
czy_wiersz_przekreslony <- function(nr_wiersza) {
  for (nr_kolumny in seq_along(arkusz$sheet_data$rows[[nr_wiersza]]$c)) {
    komorka <- arkusz$sheet_data$rows[[nr_wiersza]]$c[[nr_kolumny]]
    nr_stylu <- komorka$s
    if (!is.null(nr_stylu) && style_komorek[[as.numeric(nr_stylu)]]$font$strike) {
      return(TRUE)  # Wiersz ma przekreśloną komórkę
    }
  }
  return(FALSE)  # Wiersz nie ma przekreślonej komórki
}

# Przefiltrowanie danych - odrzucamy wiersze z przekreślonymi wartościami
wiersze_do_zachowania <- sapply(1:nrow(dane), function(i) !czy_wiersz_przekreslony(i))

# Finalny zestaw danych bez wierszy z przekreślonymi komórkami
dane_bez_przekreslen <- dane[wiersze_do_zachowania, ]

# Wyświetlenie przetworzonych danych
print(dane_bez_przekreslen)
