iResult = connect(ConnectSocket, ptr->ai_addr, (int)ptr->ai_addrlen);
if (iResult == SOCKET_ERROR) {
    std::cerr << "connect failed with error: " << WSAGetLastError() << std::endl;
    closesocket(ConnectSocket);
    ConnectSocket = INVALID_SOCKET;
    WSACleanup();
    return 1;
} else {
    std::cerr << "connect succeeded" << std::endl;
}


iResult = send(ConnectSocket, sendbuf, (int)strlen(sendbuf), 0);
if (iResult == SOCKET_ERROR) {
    std::cerr << "send failed with error: " << WSAGetLastError() << std::endl;
    closesocket(ConnectSocket);
    WSACleanup();
    return 1;
} else {
    std::cerr << "Bytes Sent: " << iResult << std::endl;
}


iResult = recv(ConnectSocket, recvbuf, recvbuflen, 0);
if (iResult > 0) {
    std::cerr << "Bytes received: " << iResult << std::endl;
} else if (iResult == 0) {
    std::cerr << "Connection closed" << std::endl;
} else {
    std::cerr << "recv failed with error: " << WSAGetLastError() << std::endl;
}


