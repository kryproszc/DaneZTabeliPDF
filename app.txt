coordinates_sf <- st_as_sf(coordinates, coords = c("longitude", "latitude"), crs = 4326)  # Zamiana coordinates na sf
coordinates_with_gminy <- st_join(coordinates_sf, punkty_gminy, join = st_within)

budynki_w_gminach <- coordinates_with_gminy %>%
  group_by(REGON) %>%
  summarise(total_budynkow = sum(ilosc, na.rm = TRUE))

punkty_gminy_z_budynkami <- left_join(punkty_gminy, budynki_w_gminach, by = "REGON")
