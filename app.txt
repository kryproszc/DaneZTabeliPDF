import pandas as pd
import numpy as np

# Lista z liczbami i pustymi miejscami
data = [1, 2, np.nan, 4, 5]

# Tworzenie DataFrame z typem nullable integer
df = pd.DataFrame({'numbers': data}, dtype=pd.Int64Dtype())

# Zamiana NaN na puste stringi
df['numbers'] = df['numbers'].apply(lambda x: '' if pd.isna(x) else x)

# Konwersja kolumny z powrotem do int gdzie to możliwe
df['numbers'] = df['numbers'].apply(lambda x: int(x) + 1 if x != '' else '')

# Sprawdzenie wyników
print(df)
print(df.dtypes)
