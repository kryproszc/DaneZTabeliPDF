# Konwersja obiektu sf do data.frame
coordinates_with_regon_df <- as.data.frame(coordinates_with_regon)

# Usunięcie kolumny geometry, ponieważ `data.frame` nie obsługuje geometrii
coordinates_with_regon_df <- coordinates_with_regon_df %>% select(-geometry)

# Grupowanie i sumowanie liczby budynków dla każdej gminy na podstawie REGON
building_summary <- coordinates_with_regon_df %>%
  group_by(REGON) %>%
  summarise(total_buildings = sum(ilosc, na.rm = TRUE))

# Połączenie z danymi gminy na podstawie REGON
gminy_with_buildings <- gminy %>%
  left_join(building_summary, by = "REGON")

# Sprawdzenie wyników
print(gminy_with_buildings)
