library(httr)
library(jsonlite)

# Ustawienia URL API z kodem pocztowym
adres_bazy <- "http://dft-everace:8080/search.php"
kod_pocztowy <- "32-100"  # kod pocztowy, który chcesz wyszukać

# Wykonanie zapytania GET do API
odpowiedz <- GET(adres_bazy, query = list(q = kod_pocztowy))

# Sprawdzenie statusu odpowiedzi
if (status_code(odpowiedz) == 200) {
  # Pobierz dane w formacie tekstowym (zakładamy, że jest to JSON)
  dane_tekstowe <- content(odpowiedz, as = "text", encoding = "UTF-8")
  
  # Konwersja z JSON na listę w R
  dane_sparsowane <- fromJSON(dane_tekstowe)
  
  # Sprawdzenie struktury danych
  print(dane_sparsowane)
  
  # Zakładając, że dane o budynkach są dostępne, wypisujemy wszystkie budynki
  # Dostosuj do rzeczywistej struktury odpowiedzi
  if ("address" %in% names(dane_sparsowane)) {
    budynki <- dane_sparsowane$address
    
    # Wyświetlenie wyników (np. nazwy budynków, numery)
    print(budynki)
  } else {
    print("Brak informacji o budynkach w odpowiedzi.")
  }
} else {
  print(paste("Błąd podczas połączenia. Status:", status_code(odpowiedz)))
}
