78  52.231962939999995        20.95377096     1
79        52.223771116       20.942257166     4
80  52.221099405882356 20.932437617647057     1
81  52.224451688461535 20.900595015384614     1
82   52.22588347777778 20.903477527777778     1
83   52.22976098636364 20.900782795454546     1
84  52.232756022000004       20.896691403     1
85   52.23425535888889 20.901037523333333     3
86  52.224756347328245  20.89040751755725     2
87   52.22127823061224 20.907999373469387     2
88   52.22149434583333  20.90709441388889     1
89   52.22354060476191 20.908365526190476     1
90   52.22768266666667        20.91781385     1
91   52.24420521538462 20.954291646153845     1
92   52.24633008333333        20.95495195     1
93          52.2476341 20.950342369999998     1
94   52.24096842631579 20.916241134736843     1
95   52.24913827816092  20.91928833678161     1
96   52.24221156821192  20.90143752913907     1
97   52.25424145529412 20.907226943529412     2
98   52.26451343157895 20.899796868421053     2
99   52.25304400361991 20.917446354298644     3
100 52.254853860504205 20.933542544957984     5
101  52.26066544285714 20.984474414285714     1
102         52.2606447       20.982523275     2
103 52.260747594117646 20.997432676470588     1
104  52.26004326666667         20.9986863     1
105         52.2617655         20.9952252     1
106  52.26432564285714         20.9801748     1
107        52.26975262        20.97596766     1
108 52.269132678571424  20.97447107857143     1
109 52.274126064516125 20.981343038709678     1
110 52.275656095833334 20.982018645833335     2
111 52.282684477272724 20.981535434090908     1
112  52.27674291923077 20.983295823076922     1
113  52.28264000666667 20.972842038787878     1
114 52.278682409090905  20.96464961818182     1
115 52.272401933333335          20.962184     1
116  52.26396242962963 20.961619207407406     1
117  52.26170772727273 20.959159204545454     2
118  52.26107164634146 20.967542397560976     1
119  52.26501384705882 20.966500747058824     1
120  52.25619037307692  20.97025543076923     1
121  52.27738186617647  20.94606638970588     2
122  52.28303232857143 20.952543957142858     1
123     52.28298978125     20.94255071875     1
124  52.27330845833333       20.943507925     1
125          52.266643       20.946212625     2
126  52.26784412462686 20.947181150746268     4
127  52.27916817142857 20.959187685714287     2
128  52.26850964807692 20.938818459615387     1
129  52.27104983684211 20.941573768421055     4
130        52.27158595        20.93879905     2
131 52.273760744444445         20.9532885     1
132  52.27520450769231 20.954652353846154     1
133  52.27578089318182  20.93521015909091     2
134 52.284525564864865  20.92761154864865     1
135  52.28547156481481 20.916076341666667     2
136         52.2803806  20.93651028181818     1
137  52.28576213333333 20.933713716666666     1
138         52.2863073 20.925755683333335     1
139  52.29425835661765  20.89340327132353     1
140 52.274472782456144 20.926014692982456     1
141  52.27831562558139  20.91702521860465     1
142 52.275893412195124  20.92206372195122     2
143  52.27330225652174 20.920141086956523     1
144        52.29110225      20.9452150375     1
145  52.29298710909091 20.940306503030303     1
146         52.2203564 20.985245283333334     1
147         52.2182095  21.00206501785714     1
148     52.21313521875       20.979227425     2
149         52.2132623  20.98073331111111     1
150  52.20526707692308  20.97325646923077     1
151 52.205635247500005       20.976792055     1
152  52.20526409523809 20.982044633333334     1
153        52.20302666        20.98330718     1
154      52.2025679125     20.97019505625     1
155        52.20029935 20.981618516666664     1
156  52.19547907826087 20.977408895652175     1
157        52.15082205        20.96553315     1
158  52.18891578421053 20.959007377192982     1
159  52.19335395714286 20.961731342857142     1
160 52.166751500000004 20.793118799999995     1
161 52.198022173333335 20.942200953333334     1
162  52.18797627205882 20.945784719117647     1
163   52.1798902159091 20.938797190909092     1
164  52.22216190714286 20.984356142857145     1
165  52.22047641111111 20.978145505555556     1
166         52.2173962 20.981574444444444     1
167  52.21382776222222 20.968175040000002     1
168      52.2111937375       20.973522075     1
169  52.21153736666667 20.971190566666667     1
170  52.21068412040817  20.96591807755102     1
171  52.20817986666667  20.97221401904762     1
172  52.20670208666667 20.968787523333333     1
173      52.2041356875       20.969775675     1
174  52.20085111666667 20.962855196666666     1
175  52.20455711428571         20.9690184     1
176  52.21191182962963  20.91281462839506     1
177 52.210734768421055 20.934863589473686     1
178   52.2010505829653  20.91051794164038     3
179 52.197690726666664 20.928289166666666     1
180 52.203299124000004       20.922589124     1
181  52.19165831990506  20.88508306863924    18
182  52.20155020564854 20.863232295606693     3
183  52.21126467307692 21.021530573076923     1
184 52.207415935294115 21.013069805882353     1
185      52.2048773125        21.00426525     1
186 52.211087638461535 21.020048969230768     2
187  52.20249726363636 21.011585727272728     1
188  52.20358678333333 21.009756016666664     1
189  52.19827159322034 21.014302947457626     1
190 52.190070195652176 21.023875095652176     1
191     52.19679896875       20.998238925     1
192      52.1960498425      20.9941576725     1
193 52.189132903448275 20.998377360344826     1
194       52.190902516 21.005027128000002     1
195  52.19049468461539  21.01142937692308     1
196 52.186653832558136 21.019998874418604     1
197        52.18469784        21.01278805     1
198   52.1749453117647 21.012929058823527     1
199 52.183385038157894  21.00516912236842     2
200         52.1863064       20.992782724     1
201  52.18300853384615        21.01339036     1
202 52.166782482608696  21.01246108695652     1
203 52.167828785000005        21.00571136     1
204  52.16964127333333 21.005095893333333     1
205         52.1722074 21.018575554285714     1
206 52.180959566666665 21.010520955555556     1
207      52.1713963375     21.00291814375     1
208  52.16322142254902 20.995066493137255     1
209  52.18136727307692  21.02669398653846     1
210 52.187942182608694  21.03244294347826     2
211    52.175978834375    21.028171028125     1
212  52.17343804444444 21.027551096296296     1
213         52.1705303  21.02488277027027     1
214  52.16789108605769 21.059123710576923     1
215  52.18315593076923  21.05020929230769     1
216  52.18092423421053 21.051941768421052     1
217  52.17547033076923 21.051737669230768     1
218 52.177907492307696         21.0573219     3
219 52.153047325773194 21.049973769329895     5
220  52.15316438154762          21.047013     4
221 52.154066848497855 21.025506088412016     3
222  52.15128406357143 21.050317382857145     3
223  52.14623345462963 21.064318319444446     1
224  52.14388405714286  21.05849262857143     1
225     52.13948775625         21.0446526     1
226  52.13419012371134 21.070683565206185     1
227  52.14637916666667 21.065906713972055     2
228  52.15517103690476 21.006440682142856     1
229  52.13812558248588  21.01045638220339     1
230   52.1288702972973 21.022518686486485     3
231  52.11692343461539  21.01449752692308     1
232  52.10742610039526 21.027682929249014     1
233  52.18935424210526 21.061345836842104     2
234 52.193572418367346  21.06276423265306     1
235  52.18213670952381 21.069052942857144     2
236  52.18819155882353 21.052516470588234     1
237 52.182989059259256 21.059759414814813     1
238 52.183942859574465 21.062639921276595     1
239 52.190609570212764 21.054926478723402     1
240  52.17234726861314  21.07346174562044     1
241         52.1730256 21.065638641666666     1
242 52.160896197019866 21.072164085430465     3
243 52.335449559090904 21.006295486363637     1
244  52.33162607333333  21.01876417384615     1
245  52.33344628181818  20.97024283636364     1
246   52.3180548328125   20.9596524546875     5
247  52.31931895789474         20.9556579     3
248  52.32854013193277 20.946423686554624     1
249  52.33300118457143  20.93670693714286     3
250       52.335471328       20.952702156     1
251  52.32610587464789  20.94801433239437     1
252 52.343901173913046 20.941138478260868     1
253  52.34049968106796 20.945381568446603     1
254  52.34246254401544 20.960825016988416     1
255  52.31288908897638 20.966138855905513     1
256  52.31954435769231 20.946161996153847     1
257  52.31506207966102  20.96432603983051     1
258   52.3065216703125      20.9927158875     1
259       52.304965475         20.9920328     1
260        52.29988818 21.044686263333332     1
261    52.298902909375    21.035536871875     1
262  52.29276752380952 21.032505735714288     1
263  52.29447863406593 21.035932132967034     2
264   52.3193480971564  21.03106202251185     4
265 52.313116484249086   21.0313662025641     1
266  52.30345048055556  21.04249741388889     1
267        52.30160801        21.04006425     1
268  52.29044558899083 21.055573211009175     1
269 52.297099551162795 21.059019960465115     1
270 52.325382724949904 21.066389853406815     3
271 52.331023208415004 21.050877717843868     3
272   52.3176481975052 21.074137886070687     3
273  52.29286279285714 21.052890085714285     1
274   52.2684733390625    21.017334103125     1
275       52.285652688 21.025857652000003     2
276  52.28176410333334        21.02319412     1
277  52.28481760208333 21.026481522916665     1
278  52.28857984705882  21.03471066470588     2
279 52.287756404545455 21.044304081818183     1
280  52.28766818139535 21.028876790697673     1
281  52.28879856388889 21.024209619444445     2
282 52.296193330952384 21.045794216666664     1
283         51.2264948 20.853874598831773     1
284     52.26004896875     21.04485669375     1
285 52.264440551724135 21.042719972413792     1
286          52.257912 21.037865666666665     1
287 52.259942547826086 21.039706347826087     1
288  52.26175946774194 21.041252003225807     1
289 52.263348535294114 21.040874847058824     2
290  52.26565233333333         21.0385546     1
291  52.26049786190477  21.02885629047619     1
292  52.26266937333334  21.02887752666667     1
293        52.26346187        21.02559794     1
294  52.26844296666667 21.047311733333334     2
295  52.27073442857143 21.049996514285713     1
296 52.272987228571424         21.0443907     1
297  52.27297205238096 21.045737414285714     3
298  52.26851291818182  21.05665889090909     1
299  52.27279338333333 21.053371533333333     1
300 52.276535547222224  21.06168527361111     2
301 52.286160853913046 21.084009236521737     1
302 52.283066454545455 21.081279363636362     2
303       52.289302375 21.082182607954547     1
304  52.25219390833333 21.033140041666666     1
305     52.24992335625     21.03315289375     2
306     52.25057155625     21.03264094375     1
307       52.249820475     21.03742588125     1
308        52.24784675         21.0499711     1
309 52.250018042307694 21.040400823076922     2
310        52.25333474 21.035420180000003     1
311 52.250373706666664 21.037528746666666     1
312  52.24898197142857  21.04555952142857     1
313  52.25113814090909 21.040506186363636     1
314  52.25372694615384 21.043373869230766     2
315  52.25457311333333  21.04317492222222     1
316 52.252481964285714 21.042546235714287     1
317  52.25449363333333         21.0526704     1
318  52.24989603333333         21.0718263     1
319        52.24498052 21.072468484999998     1
320  52.23675495789474 21.049548078947367     3
321        52.23626742       21.052748744     1
322  52.23928723777777  21.05897321111111     1
323  52.23470262735042 21.066454917094017     1
324 52.230947322000006        21.06480496     2
325  52.23077716363636 21.059532327272727     1
326        52.22695645        21.06191605     1
327      52.2285098125      21.0646568375     1
328  52.22549935714286  21.07114509047619     5
329  52.22630830243902 21.065888190243903     2
330  52.22416547142857 21.062483485714285     1
331  52.22424476666667 21.066410405128206     4
332 52.225571191463416  21.10209961097561     4
333 52.224913320708445 21.093876632425065     4
 [ reached 'max' / getOption("max.print") -- omitted 5625 rows ]
> df_sf <- st_as_sf(coordinates, coords = c("longitude", "latitude"), crs = 4326)
> df_sf
Simple feature collection with 5958 features and 1 field
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 14.21815 ymin: 49.16588 xmax: 23.89589 ymax: 54.83099
Geodetic CRS:  WGS 84
First 10 features:
   ilosc                  geometry
1      1 POINT (21.00948 52.23753)
2      1 POINT (21.00762 52.23776)
3      1  POINT (21.0104 52.23813)
4      1  POINT (21.0113 52.23916)
5      1  POINT (21.0133 52.24419)
6      1 POINT (21.01251 52.24636)
7      1  POINT (20.9977 52.23645)
8      1 POINT (20.99903 52.23958)
9      1 POINT (21.00322 52.24069)
10     2 POINT (20.99865 52.24296)
> gminy <- st_read("gminy/gminy.shp")  
Reading layer `gminy' from data source 
  `I:\WOM\Sprawy_bieĹĽÄ…ce\Model ryzyka poĹĽaru\Model YE2023\1_programy pomocnicze\tworzenie_map_gmin\gminy\gminy.shp' using driver `ESRI Shapefile'
Simple feature collection with 2477 features and 36 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 171677.5 ymin: 133223.4 xmax: 861895.8 ymax: 775019.1
Projected CRS: ETRS89 / Poland CS92
> # Dołączenie punktów do granic gmin
> df_joined <- st_join(gminy, df_sf, join = st_contains)
Error in st_geos_binop("contains", x, y, sparse = sparse, prepared = prepared,  : 
  zmienna st_crs(x) == st_crs(y) nie ma wartości TRUE
> df_sf
Simple feature collection with 5958 features and 1 field
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 14.21815 ymin: 49.16588 xmax: 23.89589 ymax: 54.83099
Geodetic CRS:  WGS 84
First 10 features:
   ilosc                  geometry
1      1 POINT (21.00948 52.23753)
2      1 POINT (21.00762 52.23776)
3      1  POINT (21.0104 52.23813)
4      1  POINT (21.0113 52.23916)
5      1  POINT (21.0133 52.24419)
6      1 POINT (21.01251 52.24636)
7      1  POINT (20.9977 52.23645)
8      1 POINT (20.99903 52.23958)
9      1 POINT (21.00322 52.24069)
10     2 POINT (20.99865 52.24296)
> gminy
Simple feature collection with 2477 features and 36 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 171677.5 ymin: 133223.4 xmax: 861895.8 ymax: 775019.1
Projected CRS: ETRS89 / Poland CS92
First 10 features:
   gml_id JPT_SJR_KO JPT_POWIER JPT_KOD_JE     JPT_NAZWA_ JPT_ORGAN_ JPT_JOR_ID WERSJA_OD WERSJA_DO WAZNY_OD WAZNY_DO JPT_KOD__1 JPT_NAZWA1
1    <NA>        GMI       4889    3215011     Szczecinek       <NA>      13151  20120926         0 20120926        0       <NA>       <NA>
2    <NA>        GMI      15063    0619072   Wola Uhruska       <NA>      13176  20120926         0 20120926        0       <NA>       <NA>
3    <NA>        GMI      19465    2214023          Gniew       <NA>      13208  20120926         0 20120926        0       <NA>       <NA>
4    <NA>        GMI       9068    2214032    Morzeszczyn       <NA>      13208  20120926         0 20120926        0       <NA>       <NA>
5    <NA>        GMI      10903    1406062      Jasieniec       <NA>      13265  20120926         0 20120926        0       <NA>       <NA>
6    <NA>        GMI      24419    1407053      Kozienice       <NA>      13266  20120926         0 20120926        0       <NA>       <NA>
7    <NA>        GMI      12143    1811052         Mielec       <NA>      13407  20120926         0 20120926        0       <NA>       <NA>
8    <NA>        GMI       5541    1811022         Borowa       <NA>      13407  20120926         0 20120926        0       <NA>       <NA>
9    <NA>        GMI       7152    1811062 Padew Narodowa       <NA>      13407  20120926         0 20120926        0       <NA>       <NA>
10   <NA>        GMI       7417    1213062       Oświęcim       <NA>      13325  20120926         0 20120926        0       <NA>       <NA>
   JPT_ORGAN1 JPT_WAZNA_ ID_BUFORA_ ID_BUFORA1 ID_TECHNIC   IIP_PRZEST                           IIP_IDENTY                IIP_WERSJA
1         NZN        NZN      13616          0     828110 PL.PZGIK.200 f3535d28-7251-4b68-b534-c815f3f89259 2012-09-26T22:34:52+02:00
2         NZN        NZN      13642          0     828350 PL.PZGIK.200 80f0f2c3-cc9a-46c6-b106-a0b3f90742ad 2012-09-26T22:43:18+02:00
3         NZN        NZN      13674          0     828600 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00
4         NZN        NZN      13674          0     828604 PL.PZGIK.200 94e48aeb-a203-4d29-ba01-9aba199c1fb8 2012-09-26T22:46:25+02:00
5         NZN        NZN      13731          0     826035 PL.PZGIK.200 f12aa5e1-8849-46a4-bad2-ccf226bdcad0 2012-09-26T21:57:51+02:00
6         NZN        NZN      13732          0     826050 PL.PZGIK.200 03ad8d48-35dc-4fc8-8e3d-cdf01d08fee2 2012-09-26T21:58:00+02:00
7         NZN        NZN      13767          0     826304 PL.PZGIK.200 606cd21b-7250-4a14-a951-eb4493e1ef0b 2012-09-26T22:01:24+02:00
8         NZN        NZN      13767          0     826307 PL.PZGIK.200 2db4e6cb-71bc-457f-98f5-8f216aecbde7 2012-09-26T22:01:24+02:00
9         NZN        NZN      13767          0     826309 PL.PZGIK.200 bd60aaa9-2ae5-44b1-9268-c0a798b79cc7 2012-09-26T22:01:24+02:00
10        NZN        NZN      13793          0     826565 PL.PZGIK.200 0ced91c1-f9ee-4499-b395-d2354acfba6c 2012-09-26T22:11:49+02:00
   JPT_KJ_IIP JPT_KJ_I_1 JPT_KJ_I_2 JPT_OPIS JPT_SPS_KO ID_BUFOR_1 JPT_ID JPT_POWI_1 JPT_KJ_I_3 JPT_GEOMET JPT_GEOM_1    SHAPE_LENG
1        EGIB    3215011       <NA>     <NA>        UZG          0 828110          0       <NA>          0          0   .5910644718
2        EGIB    0619072       <NA>     <NA>        UZG          0 828350          0       <NA>          0          0 1.26667897699
3        EGIB    2214023       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0 1.17648653548
4        EGIB    2214032       <NA>     <NA>        UZG          0 828604          0       <NA>          0          0  .71824335003
5        EGIB    1406062       <NA>     <NA>        UZG          0 826035          0       <NA>          0          0  .72102677759
6        EGIB    1407053       <NA>     <NA>        UZG          0 826050          0       <NA>          0          0 1.21859070844
7        EGIB    1811052       <NA>     <NA>        UZG          0 826304          0       <NA>          0          0 1.31379185096
8        EGIB    1811022       <NA>     <NA>        UZG          0 826307          0       <NA>          0          0  .50642846078
9        EGIB    1811062       <NA>     <NA>        UZG          0 826309          0       <NA>          0          0  .70228811549
10       EGIB    1213062       <NA>     <NA>        UZG          0 826565          0       <NA>          0          0 1.03543521462
     SHAPE_AREA          REGON RODZAJ                       geometry
1  .00659579547 33092090800000  gmina MULTIPOLYGON (((348589.9 64...
2  .01943350175 11019785900000  gmina MULTIPOLYGON (((822697.5 38...
3  .02647713213 19167529600000  gmina MULTIPOLYGON (((481876 6465...
4  .01244126039 19167531000000  gmina MULTIPOLYGON (((476330.8 65...
5  .01410220051 67022372900000  gmina MULTIPOLYGON (((637554 4317...
6  .03165358518 67022333300000  gmina MULTIPOLYGON (((679556.5 40...
7  .01548215139 69058191000000  gmina MULTIPOLYGON (((683584.7 26...
8  .00699178764 69058188000000  gmina MULTIPOLYGON (((669537.5 27...
9  .00901644681 83040936000000  gmina MULTIPOLYGON (((682876.7 28...
10 .00938374347 07218187600000  gmina MULTIPOLYGON (((517033.6 23...
> # Dołączenie punktów do granic gmin
> df_joined <- st_join(gminy, df_sf, join = st_contains)
Error in st_geos_binop("contains", x, y, sparse = sparse, prepared = prepared,  : 
  zmienna st_crs(x) == st_crs(y) nie ma wartości TRUE
> # Dołączenie punktów do granic gmin
> if (st_crs(gminy) != st_crs(df_sf)) {
+   df_sf <- st_transform(df_sf, st_crs(gminy)$epsg)
+ }
 Error: crs not found: is it missing? 
> # Dołączenie punktów do granic gmin
> if (st_crs(gminy) != st_crs(df_sf)) {
+   df_sf <- st_transform(df_sf, st_crs(gminy)$epsg)
+ }
 Error: crs not found: is it missing? 
> # Łączenie danych punktowych z granicami gmin
> df_joined <- st_join(gminy, df_sf, join = st_contains)
Error in st_geos_binop("contains", x, y, sparse = sparse, prepared = prepared,  : 
  zmienna st_crs(x) == st_crs(y) nie ma wartości TRUE
> st_crs(gminy)$epsg
[1] NA
> if (is.na(st_crs(gminy))) {
+   st_crs(gminy) <- 2180  # Ustawienie CRS dla granic gmin
+ }
> df_sf <- st_transform(df_sf, st_crs(gminy))
> df_joined <- st_join(gminy, df_sf, join = st_contains)
> df_joined
Simple feature collection with 6561 features and 37 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 171677.5 ymin: 133223.4 xmax: 861895.8 ymax: 775019.1
Projected CRS: ETRS89 / Poland CS92
First 10 features:
    gml_id JPT_SJR_KO JPT_POWIER JPT_KOD_JE   JPT_NAZWA_ JPT_ORGAN_ JPT_JOR_ID WERSJA_OD WERSJA_DO WAZNY_OD WAZNY_DO JPT_KOD__1 JPT_NAZWA1
1     <NA>        GMI       4889    3215011   Szczecinek       <NA>      13151  20120926         0 20120926        0       <NA>       <NA>
2     <NA>        GMI      15063    0619072 Wola Uhruska       <NA>      13176  20120926         0 20120926        0       <NA>       <NA>
3     <NA>        GMI      19465    2214023        Gniew       <NA>      13208  20120926         0 20120926        0       <NA>       <NA>
3.1   <NA>        GMI      19465    2214023        Gniew       <NA>      13208  20120926         0 20120926        0       <NA>       <NA>
3.2   <NA>        GMI      19465    2214023        Gniew       <NA>      13208  20120926         0 20120926        0       <NA>       <NA>
3.3   <NA>        GMI      19465    2214023        Gniew       <NA>      13208  20120926         0 20120926        0       <NA>       <NA>
3.4   <NA>        GMI      19465    2214023        Gniew       <NA>      13208  20120926         0 20120926        0       <NA>       <NA>
3.5   <NA>        GMI      19465    2214023        Gniew       <NA>      13208  20120926         0 20120926        0       <NA>       <NA>
3.6   <NA>        GMI      19465    2214023        Gniew       <NA>      13208  20120926         0 20120926        0       <NA>       <NA>
3.7   <NA>        GMI      19465    2214023        Gniew       <NA>      13208  20120926         0 20120926        0       <NA>       <NA>
    JPT_ORGAN1 JPT_WAZNA_ ID_BUFORA_ ID_BUFORA1 ID_TECHNIC   IIP_PRZEST                           IIP_IDENTY                IIP_WERSJA
1          NZN        NZN      13616          0     828110 PL.PZGIK.200 f3535d28-7251-4b68-b534-c815f3f89259 2012-09-26T22:34:52+02:00
2          NZN        NZN      13642          0     828350 PL.PZGIK.200 80f0f2c3-cc9a-46c6-b106-a0b3f90742ad 2012-09-26T22:43:18+02:00
3          NZN        NZN      13674          0     828600 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00
3.1        NZN        NZN      13674          0     828600 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00
3.2        NZN        NZN      13674          0     828600 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00
3.3        NZN        NZN      13674          0     828600 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00
3.4        NZN        NZN      13674          0     828600 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00
3.5        NZN        NZN      13674          0     828600 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00
3.6        NZN        NZN      13674          0     828600 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00
3.7        NZN        NZN      13674          0     828600 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00
    JPT_KJ_IIP JPT_KJ_I_1 JPT_KJ_I_2 JPT_OPIS JPT_SPS_KO ID_BUFOR_1 JPT_ID JPT_POWI_1 JPT_KJ_I_3 JPT_GEOMET JPT_GEOM_1    SHAPE_LENG
1         EGIB    3215011       <NA>     <NA>        UZG          0 828110          0       <NA>          0          0   .5910644718
2         EGIB    0619072       <NA>     <NA>        UZG          0 828350          0       <NA>          0          0 1.26667897699
3         EGIB    2214023       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0 1.17648653548
3.1       EGIB    2214023       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0 1.17648653548
3.2       EGIB    2214023       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0 1.17648653548
3.3       EGIB    2214023       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0 1.17648653548
3.4       EGIB    2214023       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0 1.17648653548
3.5       EGIB    2214023       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0 1.17648653548
3.6       EGIB    2214023       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0 1.17648653548
3.7       EGIB    2214023       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0 1.17648653548
      SHAPE_AREA          REGON RODZAJ ilosc                       geometry
1   .00659579547 33092090800000  gmina    24 MULTIPOLYGON (((348589.9 64...
2   .01943350175 11019785900000  gmina    NA MULTIPOLYGON (((822697.5 38...
3   .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.1 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.2 .02647713213 19167529600000  gmina     3 MULTIPOLYGON (((481876 6465...
3.3 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.4 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.5 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.6 .02647713213 19167529600000  gmina     2 MULTIPOLYGON (((481876 6465...
3.7 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
> gminy_aggregated <- df_joined %>%
+   group_by(gmina) %>%
+   summarize(ilosc = sum(ilosc, na.rm = TRUE))
Error in `st_as_sf()`:
! Must group by variables found in `.data`.
x Column `gmina` is not found.
Run `rlang::last_trace()` to see where the error occurred.
> st_contains
function (x, y, sparse = TRUE, prepared = TRUE, ..., model = "open") 
st_geos_binop("contains", x, y, sparse = sparse, prepared = prepared, 
    ..., model = model)
<bytecode: 0x000001602dd4d2e0>
<environment: namespace:sf>
> library(dplyr)
> 
> # Upewniamy się, że mamy odpowiednie dane do wizualizacji
> # Jeśli `df_joined` zawiera już `geometry` i `ilosc`, możemy od razu stworzyć mapę
> 
> ggplot(data = df_joined) +
+   geom_sf(aes(fill = ilosc), color = "black") +  # Kolorowanie gmin na podstawie liczby budynków
+   scale_fill_viridis_c(option = "plasma", trans = "log") +  # Skala kolorów logarytmiczna
+   theme_minimal() +
+   labs(title = "Mapa gmin z liczbą budynków",
+        fill = "Liczba budynków") +
+   theme(plot.title = element_text(hjust = 0.5))
Error in UseMethod("depth") : 
  no applicable method for 'depth' applied to an object of class "NULL"
> ##
> print(class(df_joined))         # Powinno zwrócić coś takiego: "sf" "data.frame"
[1] "sf"         "data.frame"
> print(st_geometry_type(df_joined)) 
   [1] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
   [8] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
  [15] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
  [22] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
  [29] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
  [36] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
  [43] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
  [50] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
  [57] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
  [64] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
  [71] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
  [78] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
  [85] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
  [92] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
  [99] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [106] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [113] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [120] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [127] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [134] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [141] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [148] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [155] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [162] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [169] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [176] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [183] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [190] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [197] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [204] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [211] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [218] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [225] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [232] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [239] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [246] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [253] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [260] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [267] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [274] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [281] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [288] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [295] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [302] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [309] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [316] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [323] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [330] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [337] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [344] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [351] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [358] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [365] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [372] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [379] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [386] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [393] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [400] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [407] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [414] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [421] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [428] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [435] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [442] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [449] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [456] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [463] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [470] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [477] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [484] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [491] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [498] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [505] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [512] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [519] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [526] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [533] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [540] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [547] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [554] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [561] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [568] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [575] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [582] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [589] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [596] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [603] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [610] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [617] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [624] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [631] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [638] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [645] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [652] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [659] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [666] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [673] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [680] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [687] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [694] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [701] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [708] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [715] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [722] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [729] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [736] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [743] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [750] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [757] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [764] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [771] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [778] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [785] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [792] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [799] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [806] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [813] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [820] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [827] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [834] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [841] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [848] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [855] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [862] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [869] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [876] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [883] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [890] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [897] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [904] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [911] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [918] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [925] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [932] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [939] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [946] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [953] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [960] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [967] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [974] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [981] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [988] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [995] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [ reached getOption("max.print") -- omitted 5561 entries ]
18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT MULTILINESTRING ... TRIANGLE
> print(names(df_joined))  # Powinno zwrócić kolumnę "geometry"
 [1] "gml_id"     "JPT_SJR_KO" "JPT_POWIER" "JPT_KOD_JE" "JPT_NAZWA_" "JPT_ORGAN_" "JPT_JOR_ID"
 [8] "WERSJA_OD"  "WERSJA_DO"  "WAZNY_OD"   "WAZNY_DO"   "JPT_KOD__1" "JPT_NAZWA1" "JPT_ORGAN1"
[15] "JPT_WAZNA_" "ID_BUFORA_" "ID_BUFORA1" "ID_TECHNIC" "IIP_PRZEST" "IIP_IDENTY" "IIP_WERSJA"
[22] "JPT_KJ_IIP" "JPT_KJ_I_1" "JPT_KJ_I_2" "JPT_OPIS"   "JPT_SPS_KO" "ID_BUFOR_1" "JPT_ID"    
[29] "JPT_POWI_1" "JPT_KJ_I_3" "JPT_GEOMET" "JPT_GEOM_1" "SHAPE_LENG" "SHAPE_AREA" "REGON"     
[36] "RODZAJ"     "ilosc"      "geometry"  
> # Zamiana na obiekt sf, jeśli `df_joined` nie jest obiektem sf
> if (!inherits(df_joined, "sf")) {
+   df_joined <- st_as_sf(df_joined)
+ }
> head(df_joined$geometry) 
Geometry set for 6 features 
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 342292.4 ymin: 387718.3 xmax: 828298.2 ymax: 673713.6
Projected CRS: ETRS89 / Poland CS92
First 5 geometries:
MULTIPOLYGON (((348589.9 646387.8, 348586.3 646...
MULTIPOLYGON (((822697.5 387738.8, 822671.8 387...
MULTIPOLYGON (((481876 646587.6, 481847.8 64661...
MULTIPOLYGON (((481876 646587.6, 481847.8 64661...
MULTIPOLYGON (((481876 646587.6, 481847.8 64661...
> df_joined$ilosc[is.na(df_joined$ilosc)] <- 0  # Zamiana NA na 0
> ggplot(data = df_joined) +
+   geom_sf(aes(fill = ilosc), color = "black") +  # Kolorowanie gmin na podstawie liczby budynków
+   scale_fill_viridis_c(option = "plasma", trans = "log") +  # Skala kolorów logarytmiczna
+   theme_minimal() +
+   labs(title = "Mapa gmin z liczbą budynków",
+        fill = "Liczba budynków") +
+   theme(plot.title = element_text(hjust = 0.5))
Warning message:
In scale_fill_viridis_c(option = "plasma", trans = "log") :
  log-2.718282 transformation introduced infinite values.
> df_joined$ilosc[df_joined$ilosc>0,] <- 0  # Zamiana NA na 0
Error in df_joined$ilosc[df_joined$ilosc > 0, ] <- 0 : 
  incorrect number of subscripts on matrix
> df_joined<-df_joined[df_joined$ilosc>0,] <- 0  # Zamiana NA na 0
Error in UseMethod("st_bbox") : 
  no applicable method for 'st_bbox' applied to an object of class "list"
> df_joined
Simple feature collection with 6561 features and 37 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 171677.5 ymin: 133223.4 xmax: 861895.8 ymax: 775019.1
Projected CRS: ETRS89 / Poland CS92
First 10 features:
    gml_id JPT_SJR_KO JPT_POWIER JPT_KOD_JE   JPT_NAZWA_ JPT_ORGAN_ JPT_JOR_ID WERSJA_OD WERSJA_DO
1     <NA>        GMI       4889    3215011   Szczecinek       <NA>      13151  20120926         0
2     <NA>        GMI      15063    0619072 Wola Uhruska       <NA>      13176  20120926         0
3     <NA>        GMI      19465    2214023        Gniew       <NA>      13208  20120926         0
3.1   <NA>        GMI      19465    2214023        Gniew       <NA>      13208  20120926         0
3.2   <NA>        GMI      19465    2214023        Gniew       <NA>      13208  20120926         0
3.3   <NA>        GMI      19465    2214023        Gniew       <NA>      13208  20120926         0
3.4   <NA>        GMI      19465    2214023        Gniew       <NA>      13208  20120926         0
3.5   <NA>        GMI      19465    2214023        Gniew       <NA>      13208  20120926         0
3.6   <NA>        GMI      19465    2214023        Gniew       <NA>      13208  20120926         0
3.7   <NA>        GMI      19465    2214023        Gniew       <NA>      13208  20120926         0
    WAZNY_OD WAZNY_DO JPT_KOD__1 JPT_NAZWA1 JPT_ORGAN1 JPT_WAZNA_ ID_BUFORA_ ID_BUFORA1 ID_TECHNIC
1   20120926        0       <NA>       <NA>        NZN        NZN      13616          0     828110
2   20120926        0       <NA>       <NA>        NZN        NZN      13642          0     828350
3   20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.1 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.2 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.3 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.4 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.5 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.6 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.7 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
      IIP_PRZEST                           IIP_IDENTY                IIP_WERSJA JPT_KJ_IIP JPT_KJ_I_1
1   PL.PZGIK.200 f3535d28-7251-4b68-b534-c815f3f89259 2012-09-26T22:34:52+02:00       EGIB    3215011
2   PL.PZGIK.200 80f0f2c3-cc9a-46c6-b106-a0b3f90742ad 2012-09-26T22:43:18+02:00       EGIB    0619072
3   PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.1 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.2 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.3 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.4 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.5 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.6 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.7 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
    JPT_KJ_I_2 JPT_OPIS JPT_SPS_KO ID_BUFOR_1 JPT_ID JPT_POWI_1 JPT_KJ_I_3 JPT_GEOMET JPT_GEOM_1
1         <NA>     <NA>        UZG          0 828110          0       <NA>          0          0
2         <NA>     <NA>        UZG          0 828350          0       <NA>          0          0
3         <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.1       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.2       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.3       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.4       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.5       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.6       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.7       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
       SHAPE_LENG   SHAPE_AREA          REGON RODZAJ ilosc                       geometry
1     .5910644718 .00659579547 33092090800000  gmina    24 MULTIPOLYGON (((348589.9 64...
2   1.26667897699 .01943350175 11019785900000  gmina     0 MULTIPOLYGON (((822697.5 38...
3   1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.1 1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.2 1.17648653548 .02647713213 19167529600000  gmina     3 MULTIPOLYGON (((481876 6465...
3.3 1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.4 1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.5 1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.6 1.17648653548 .02647713213 19167529600000  gmina     2 MULTIPOLYGON (((481876 6465...
3.7 1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
> df_joined$ilosc>0
   [1]  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
  [17]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
  [33]  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE
  [49]  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
  [65]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
  [81]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE
  [97]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE
 [113]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE FALSE  TRUE FALSE  TRUE  TRUE  TRUE FALSE FALSE
 [129] FALSE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE
 [145]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE
 [161]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [177]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [193]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE
 [209]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE
 [225]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE
 [241]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE
 [257]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE  TRUE
 [273]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
 [289]  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [305]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [321] FALSE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [337]  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [353]  TRUE  TRUE FALSE FALSE FALSE  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
 [369]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [385]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [401]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE
 [417]  TRUE FALSE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [433]  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [449]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE
 [465]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [481]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE FALSE
 [497] FALSE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
 [513]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [529]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [545]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [561]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [577]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [593]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [609]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [625]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE
 [641]  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE
 [657]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [673]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [689] FALSE  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE FALSE  TRUE
 [705]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
 [721]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [737]  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [753]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
 [769] FALSE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE
 [785]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE
 [801] FALSE  TRUE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE  TRUE  TRUE
 [817]  TRUE  TRUE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [833]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE
 [849]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE
 [865] FALSE  TRUE FALSE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [881]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE FALSE  TRUE  TRUE FALSE  TRUE FALSE FALSE
 [897]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE  TRUE
 [913] FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [929]  TRUE  TRUE FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [945]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [961]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [977]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [993]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [ reached getOption("max.print") -- omitted 5561 entries ]
> df_joined<-df_joined[df_joined$ilosc>0,]
> df_joined
Simple feature collection with 5925 features and 37 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 178591.3 ymin: 141256.9 xmax: 854567.5 ymax: 775019.1
Projected CRS: ETRS89 / Poland CS92
First 10 features:
    gml_id JPT_SJR_KO JPT_POWIER JPT_KOD_JE JPT_NAZWA_ JPT_ORGAN_ JPT_JOR_ID WERSJA_OD WERSJA_DO
1     <NA>        GMI       4889    3215011 Szczecinek       <NA>      13151  20120926         0
3     <NA>        GMI      19465    2214023      Gniew       <NA>      13208  20120926         0
3.1   <NA>        GMI      19465    2214023      Gniew       <NA>      13208  20120926         0
3.2   <NA>        GMI      19465    2214023      Gniew       <NA>      13208  20120926         0
3.3   <NA>        GMI      19465    2214023      Gniew       <NA>      13208  20120926         0
3.4   <NA>        GMI      19465    2214023      Gniew       <NA>      13208  20120926         0
3.5   <NA>        GMI      19465    2214023      Gniew       <NA>      13208  20120926         0
3.6   <NA>        GMI      19465    2214023      Gniew       <NA>      13208  20120926         0
3.7   <NA>        GMI      19465    2214023      Gniew       <NA>      13208  20120926         0
3.8   <NA>        GMI      19465    2214023      Gniew       <NA>      13208  20120926         0
    WAZNY_OD WAZNY_DO JPT_KOD__1 JPT_NAZWA1 JPT_ORGAN1 JPT_WAZNA_ ID_BUFORA_ ID_BUFORA1 ID_TECHNIC
1   20120926        0       <NA>       <NA>        NZN        NZN      13616          0     828110
3   20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.1 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.2 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.3 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.4 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.5 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.6 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.7 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.8 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
      IIP_PRZEST                           IIP_IDENTY                IIP_WERSJA JPT_KJ_IIP JPT_KJ_I_1
1   PL.PZGIK.200 f3535d28-7251-4b68-b534-c815f3f89259 2012-09-26T22:34:52+02:00       EGIB    3215011
3   PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.1 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.2 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.3 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.4 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.5 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.6 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.7 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.8 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
    JPT_KJ_I_2 JPT_OPIS JPT_SPS_KO ID_BUFOR_1 JPT_ID JPT_POWI_1 JPT_KJ_I_3 JPT_GEOMET JPT_GEOM_1
1         <NA>     <NA>        UZG          0 828110          0       <NA>          0          0
3         <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.1       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.2       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.3       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.4       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.5       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.6       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.7       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.8       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
       SHAPE_LENG   SHAPE_AREA          REGON RODZAJ ilosc                       geometry
1     .5910644718 .00659579547 33092090800000  gmina    24 MULTIPOLYGON (((348589.9 64...
3   1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.1 1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.2 1.17648653548 .02647713213 19167529600000  gmina     3 MULTIPOLYGON (((481876 6465...
3.3 1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.4 1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.5 1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.6 1.17648653548 .02647713213 19167529600000  gmina     2 MULTIPOLYGON (((481876 6465...
3.7 1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.8 1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
> ggplot(data = df_joined) +
+   geom_sf(aes(fill = ilosc), color = "black") +  # Kolorowanie gmin na podstawie liczby budynków
+   scale_fill_viridis_c(option = "plasma", trans = "log") +  # Skala kolorów logarytmiczna
+   theme_minimal() +
+   labs(title = "Mapa gmin z liczbą budynków",
+        fill = "Liczba budynków") +
+   theme(plot.title = element_text(hjust = 0.5))
> ggplot(data = df_joined) +
+   geom_sf(aes(fill = ilosc), color = "black") +  
+   scale_fill_viridis_c(option = "plasma") +  
+   theme_minimal() +
+   labs(title = "Mapa gmin z liczbą budynków",
+        fill = "Liczba budynków") +
+   theme(plot.title = element_text(hjust = 0.5))
> df_joined$ilosc[df_joined$ilosc == 0] <- 0.1
> 
> # Automatyczne wyznaczenie przedziałów na podstawie wartości w kolumnie `ilosc`
> # Użyjemy funkcji `classIntervals()` do podzielenia danych na 5 dynamicznych przedziałów (lub inną liczbę)
> intervals <- classIntervals(df_joined$ilosc, n = 5, style = "quantile")
Error in classIntervals(df_joined$ilosc, n = 5, style = "quantile") : 
  could not find function "classIntervals"
> 
> # Wartości granic przedziałów
> breaks <- intervals$brks
Error: object 'intervals' not found
> 
> # Stworzenie kolumny z kategoriami na podstawie przedziałów
> df_joined$ilosc_category <- cut(
+   df_joined$ilosc,
+   breaks = breaks,  # Używamy automatycznie wyznaczonych granic
+   include.lowest = TRUE,
+   dig.lab = 10  # Zwiększenie liczby cyfr wyświetlanych w etykietach
+ )
Error in cut.default(df_joined$ilosc, breaks = breaks, include.lowest = TRUE,  : 
  object 'breaks' not found
> 
> # Przypisanie kolorów dla poszczególnych przedziałów
> # Definiujemy 6 kolorów: pierwszy dla 0.1 i 5 dla reszty przedziałów
> colors <- c("lightgray", "#fee0d2", "#fc9272", "#fb6a4a", "#de2d26", "#a50f15")
> 
> # 
> print(table(df_joined$ilosc_category))
< table of extent 0 >
> 
> #
> # Wyświetlenie liczności w poszczególnych przedziałach
> print(table(df_joined$ilosc_category))
< table of extent 0 >
> df_joined
Simple feature collection with 5925 features and 37 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 178591.3 ymin: 141256.9 xmax: 854567.5 ymax: 775019.1
Projected CRS: ETRS89 / Poland CS92
First 10 features:
    gml_id JPT_SJR_KO JPT_POWIER JPT_KOD_JE JPT_NAZWA_ JPT_ORGAN_ JPT_JOR_ID WERSJA_OD WERSJA_DO
1     <NA>        GMI       4889    3215011 Szczecinek       <NA>      13151  20120926         0
3     <NA>        GMI      19465    2214023      Gniew       <NA>      13208  20120926         0
3.1   <NA>        GMI      19465    2214023      Gniew       <NA>      13208  20120926         0
3.2   <NA>        GMI      19465    2214023      Gniew       <NA>      13208  20120926         0
3.3   <NA>        GMI      19465    2214023      Gniew       <NA>      13208  20120926         0
3.4   <NA>        GMI      19465    2214023      Gniew       <NA>      13208  20120926         0
3.5   <NA>        GMI      19465    2214023      Gniew       <NA>      13208  20120926         0
3.6   <NA>        GMI      19465    2214023      Gniew       <NA>      13208  20120926         0
3.7   <NA>        GMI      19465    2214023      Gniew       <NA>      13208  20120926         0
3.8   <NA>        GMI      19465    2214023      Gniew       <NA>      13208  20120926         0
    WAZNY_OD WAZNY_DO JPT_KOD__1 JPT_NAZWA1 JPT_ORGAN1 JPT_WAZNA_ ID_BUFORA_ ID_BUFORA1 ID_TECHNIC
1   20120926        0       <NA>       <NA>        NZN        NZN      13616          0     828110
3   20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.1 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.2 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.3 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.4 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.5 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.6 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.7 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
3.8 20120926        0       <NA>       <NA>        NZN        NZN      13674          0     828600
      IIP_PRZEST                           IIP_IDENTY                IIP_WERSJA JPT_KJ_IIP JPT_KJ_I_1
1   PL.PZGIK.200 f3535d28-7251-4b68-b534-c815f3f89259 2012-09-26T22:34:52+02:00       EGIB    3215011
3   PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.1 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.2 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.3 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.4 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.5 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.6 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.7 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
3.8 PL.PZGIK.200 4f9983c1-4c61-4908-a51a-8e5ca6b22d54 2012-09-26T22:46:25+02:00       EGIB    2214023
    JPT_KJ_I_2 JPT_OPIS JPT_SPS_KO ID_BUFOR_1 JPT_ID JPT_POWI_1 JPT_KJ_I_3 JPT_GEOMET JPT_GEOM_1
1         <NA>     <NA>        UZG          0 828110          0       <NA>          0          0
3         <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.1       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.2       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.3       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.4       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.5       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.6       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.7       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
3.8       <NA>     <NA>        UZG          0 828600          0       <NA>          0          0
       SHAPE_LENG   SHAPE_AREA          REGON RODZAJ ilosc                       geometry
1     .5910644718 .00659579547 33092090800000  gmina    24 MULTIPOLYGON (((348589.9 64...
3   1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.1 1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.2 1.17648653548 .02647713213 19167529600000  gmina     3 MULTIPOLYGON (((481876 6465...
3.3 1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.4 1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.5 1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.6 1.17648653548 .02647713213 19167529600000  gmina     2 MULTIPOLYGON (((481876 6465...
3.7 1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
3.8 1.17648653548 .02647713213 19167529600000  gmina     1 MULTIPOLYGON (((481876 6465...
> df_joined$ilosc[df_joined$ilosc == 0] <- 0.1
> # Automatyczne wyznaczenie przedziałów na podstawie wartości w kolumnie `ilosc`
> # Użyjemy funkcji `classIntervals()` do podzielenia danych na 5 dynamicznych przedziałów (lub inną liczbę)
> intervals <- classIntervals(df_joined$ilosc, n = 5, style = "quantile")
Error in classIntervals(df_joined$ilosc, n = 5, style = "quantile") : 
  could not find function "classIntervals"
> # Wartości granic przedziałów
> breaks <- intervals$brks
Error: object 'intervals' not found
> ########################################
> library(classInt)
> df_joined$ilosc[df_joined$ilosc == 0] <- 0.1
> # Automatyczne wyznaczenie przedziałów na podstawie wartości w kolumnie `ilosc`
> # Użyjemy funkcji `classIntervals()` do podzielenia danych na 5 dynamicznych przedziałów (lub inną liczbę)
> intervals <- classIntervals(df_joined$ilosc, n = 5, style = "quantile")
> # Wartości granic przedziałów
> breaks <- intervals$brks
> # Stworzenie kolumny z kategoriami na podstawie przedziałów
> df_joined$ilosc_category <- cut(
+   df_joined$ilosc,
+   breaks = breaks,  # Używamy automatycznie wyznaczonych granic
+   include.lowest = TRUE,
+   dig.lab = 10  # Zwiększenie liczby cyfr wyświetlanych w etykietach
+ )
Error in cut.default(df_joined$ilosc, breaks = breaks, include.lowest = TRUE,  : 
  wartosci w argumencie 'breaks' nie są unikalne
> # Stworzenie kolumny z kategoriami na podstawie przedziałów
> df_joined$ilosc_category <- cut(
+   df_joined$ilosc,
+  # breaks = breaks,  # Używamy automatycznie wyznaczonych granic
+   include.lowest = TRUE,
+   dig.lab = 10  # Zwiększenie liczby cyfr wyświetlanych w etykietach
+ )
Error in cut.default(df_joined$ilosc, include.lowest = TRUE, dig.lab = 10) : 
  argument "breaks" is missing, with no default
> intervals
style: quantile
  one of 2,123,555 possible partitions of this variable into 5 classes
  [1,1)   [1,1)   [1,2)   [2,4) [4,301] 
      0       0    3107    1582    1236 
