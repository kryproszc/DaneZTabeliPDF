# Przykładowe dane
trojkat_laczny <- data.frame(
  `0 rok` = c(1000, 1200, 1100, 1300, 1500),
  `1 rok` = c(500, 600, 700, 800, 900),
  `2 lata` = c(300, 400, 500, 600, 700)
)

trojkat_zadoscuczynienia <- data.frame(
  `0 rok` = c(1000, 1200, 1100, 1300, 1500),
  `1 rok` = c(500, NA, NA, NA, NA),
  `2 lata` = c(NA, NA, NA, NA, NA)
)

# Wybór ostatnich 5 komórek z trójkąta łącznego
last_five_laczny <- tail(trojkat_laczny, 5)
last_five_zadoscuczynienia <- tail(trojkat_zadoscuczynienia, 5)

# Uporządkowanie danych do wykresu
data_for_correlation <- data.frame(
  Trójkąt_Lączny = as.vector(t(last_five_laczny)),
  Trójkąt_Zadośćuczynienia = as.vector(t(last_five_zadoscuczynienia))
)

# Usunięcie NA
data_for_correlation <- na.omit(data_for_correlation)

# Obliczanie współczynnika korelacji
correlation_pearson <- cor(data_for_correlation$Trójkąt_Lączny, data_for_correlation$Trójkąt_Zadośćuczynienia, method = "pearson")
correlation_spearman <- cor(data_for_correlation$Trójkąt_Lączny, data_for_correlation$Trójkąt_Zadośćuczynienia, method = "spearman")

# Wyświetlenie współczynników korelacji
cat("Współczynnik korelacji Pearsona: ", correlation_pearson, "\n")
cat("Współczynnik korelacji Spearmana: ", correlation_spearman, "\n")

# Wykres rozrzutu
library(ggplot2)

ggplot(data_for_correlation, aes(x = Trójkąt_Lączny, y = Trójkąt_Zadośćuczynienia)) +
  geom_point(color = "blue") +
  geom_smooth(method = "lm", color = "red", se = FALSE) +  # Linia regresji
  labs(title = "Wykres Rozrzutu: Zadośćuczynienia vs. Trójkąt Łączny",
       x = "Trójkąt Łączny",
       y = "Trójkąt Zadośćuczynienia") +
  theme_minimal()
