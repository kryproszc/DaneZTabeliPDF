# Ustawienia URL API z kodem pocztowym
adres_bazy <- "http://dft-everace:8080/search.php"
kod_pocztowy <- "32-100"  # kod pocztowy, który chcesz wyszukać

# Wykonanie zapytania GET do API
odpowiedz <- GET(adres_bazy, query = list(q = kod_pocztowy))

# Sprawdzenie statusu odpowiedzi
if (status_code(odpowiedz) == 200) {
  # Pobierz dane w formacie tekstowym (zakładamy, że jest to JSON)
  dane_tekstowe <- content(odpowiedz, as = "text", encoding = "UTF-8")
  
  # Konwersja z JSON na listę w R
  dane_sparsowane <- fromJSON(dane_tekstowe)
  
  # Sprawdzenie struktury danych
  print(dane_sparsowane)
  
  # Zakładając, że dane o budynkach są dostępne, wypisujemy wszystkie budynki
  # Zmieniamy w zależności od struktury odpowiedzi (zakładamy, że informacje o budynkach są w kolumnie 'address')
  budynki <- list()  # Lista na wszystkie budynki
  
  for (i in seq_along(dane_sparsowane)) {
    if (dane_sparsowane[[i]]$type == "building") {  # Sprawdzamy, czy dany wpis to budynek
      budynek_info <- dane_sparsowane[[i]]$address
      budynki[[length(budynki) + 1]] <- budynek_info  # Dodajemy budynek do listy
    }
  }
  
  # Wyświetlenie wszystkich budynków
  if (length(budynki) > 0) {
    print(budynki)
  } else {
    print("Brak budynków dla podanego kodu pocztowego.")
  }
} else {
  print(paste("Błąd podczas połączenia. Status:", status_code(odpowiedz)))
}
