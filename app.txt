library(readxl)
library(dplyr)

# Ścieżka do pliku Excel
file_path <- "sciezka/do/pliku.xlsx"

# Funkcja do wczytywania określonych kolumn i wierszy z arkusza
read_sheet_subset <- function(sheet_name, cols, rows) {
  data <- read_excel(file_path, sheet = sheet_name, range = cell_rows(rows))
  data <- data[, cols]
  return(data)
}

# Pobranie nazw wszystkich arkuszy
sheet_names <- excel_sheets(file_path)

# Wczytanie określonych kolumn i wierszy z każdego arkusza do listy
cols_to_read <- c("Kolumna1", "Kolumna2") # Zmień na nazwy kolumn, które chcesz wczytać
rows_to_read <- 1:10 # Zmień na zakres wierszy, które chcesz wczytać

data_list <- lapply(sheet_names, function(sheet) {
  read_sheet_subset(sheet, cols_to_read, rows_to_read)
})

# Przypisanie nazw arkuszy jako nazw listy
names(data_list) <- sheet_names

# Funkcja do pobierania tabeli na podstawie nazwy arkusza
get_table_by_sheet <- function(sheet_name) {
  return(data_list[[sheet_name]])
}

# Przykład użycia funkcji
sheet_to_get <- "Sheet1" # Zmień na nazwę arkusza, który chcesz pobrać
table <- get_table_by_sheet(sheet_to_get)
print(table)
