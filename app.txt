# Wczytanie bibliotek
library(sf)
library(dplyr)

# Zakładam, że oba zbiory są już wczytane: coordinates i gminy_unikaty

# Konwersja zbioru coordinates do obiektu sf
coordinates_sf <- st_as_sf(coordinates, coords = c("longitude", "latitude"), crs = 4326)

# Sprawdzenie systemu współrzędnych obu zbiorów
st_crs(gminy_unikaty)
st_crs(coordinates_sf)

# Jeśli systemy współrzędnych są różne, należy je ujednolicić (transformacja do tego samego CRS)
# Transformacja coordinates do CRS gminy_unikaty (jeśli to konieczne)
coordinates_sf <- st_transform(coordinates_sf, st_crs(gminy_unikaty))

# Przestrzenne przypisanie (spatial join) – przypisujemy regon do coordinates
coordinates_with_regon <- st_join(coordinates_sf, gminy_unikaty["REGON"], join = st_within)

# Sprawdzenie wyniku
print(coordinates_with_regon)

# Opcjonalnie, możesz zapisać wynik do nowego pliku
# st_write(coordinates_with_regon, "coordinates_with_regon.shp")
