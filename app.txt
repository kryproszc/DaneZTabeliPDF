library(readxl)
library(dplyr)

# Ścieżka do pliku Excel
file_path <- "sciezka/do/pliku.xlsx"

# Funkcja do wczytywania określonych kolumn i wierszy z arkusza
read_sheet_subset <- function(sheet_name) {
  # Definiowanie zakresu wierszy i kolumn
  range <- "A6:Z29"
  data <- read_excel(file_path, sheet = sheet_name, range = range)
  return(data)
}

# Pobranie nazw wszystkich arkuszy
sheet_names <- excel_sheets(file_path)

# Wczytanie określonych kolumn i wierszy z każdego arkusza do listy
data_list <- lapply(sheet_names, function(sheet) {
  read_sheet_subset(sheet)
})

# Przypisanie nazw arkuszy jako nazw listy
names(data_list) <- sheet_names

# Funkcja do pobierania tabeli na podstawie nazwy arkusza
get_table_by_sheet <- function(sheet_name) {
  return(data_list[[sheet_name]])
}

# Przykład użycia funkcji
sheet_to_get <- "Sheet1" # Zmień na nazwę arkusza, który chcesz pobrać
table <- get_table_by_sheet(sheet_to_get)
print(table)
