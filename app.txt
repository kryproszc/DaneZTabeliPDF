# Sprawdzenie liczby budynków przypisanych do każdej gminy przed i po join
roznice_po_join <- gminy_z_budynkami %>%
  select(REGON, total_budynkow) %>%
  inner_join(wynik_gminy_df, by = "REGON", suffix = c("_po_join", "_przed_join"))

# Porównanie wartości `total_budynkow` przed i po join
roznice_po_join <- roznice_po_join %>%
  mutate(roznica = total_budynkow_po_join - total_budynkow_przed_join) %>%
  filter(roznica != 0)  # Wyświetlenie tylko tych wierszy, gdzie są różnice

# Wyświetlenie gmin z różnicą w sumach budynków
print(roznice_po_join)




# Sprawdzenie liczby wystąpień każdego REGON w gminy
wystapienia_gmin <- gminy %>%
  group_by(REGON) %>%
  summarise(liczba_wystapien = n())

# Wyświetlenie tych REGON, które występują więcej niż raz
wystapienia_gmin_duplikaty <- wystapienia_gmin %>%
  filter(liczba_wystapien > 1)
print(wystapienia_gmin_duplikaty)


gminy_z_budynkami_bez_powtorzen <- gminy_z_budynkami %>%
  group_by(REGON) %>%
  summarise(total_budynkow = sum(total_budynkow, na.rm = TRUE))

sum(gminy_z_budynkami_bez_powtorzen$total_budynkow)


gminy_z_budynkami_inner <- inner_join(gminy, wynik_gminy_df, by = "REGON")
sum(gminy_z_budynkami_inner$total_budynkow)
