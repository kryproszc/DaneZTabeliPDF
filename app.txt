g++ programtest23.cpp -O3 -lpqxx -lpq -DUPDATE && ./a.out


CREATE INDEX idx_postcode ON placex ((address -> 'postcode'));
CREATE INDEX idx_housenumber ON placex ((address -> 'housenumber'));
CREATE INDEX idx_city ON placex ((address -> 'city'));
(
    SELECT 
        3 AS Flag,
        '12 1960 1961 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '05-825'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 3
)
UNION ALL
(
    SELECT 
        3 AS Flag,
        '891 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '16-315'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        6 AS Flag,
        '2016 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '21-109'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        7 AS Flag,
        '2018 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '30-392'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        0 AS Flag,
        '2014 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '60-213'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        3 AS Flag,
        '1692 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '68-343'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        3 AS Flag,
        '799 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '76-150'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        3 AS Flag,
        '104 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '87-148'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        3 AS Flag,
        '1713 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '89-210'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '1885 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '85-081'
        AND address -> 'city' ILIKE 'Bydgoszcz'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '656 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '44-230'
        AND address -> 'city' ILIKE 'Czerwionka-Leszczyny'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '162 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '44-100'
        AND address -> 'city' ILIKE 'Gliwice'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '785 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '44-350'
        AND address -> 'city' ILIKE 'Gorzyczki'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '1276 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '05-825'
        AND address -> 'city' ILIKE 'Grodzisk Mazowiecki'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '1593 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '32-310'
        AND address -> 'city' ILIKE 'Klucze'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '951 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '30-392'
        AND address -> 'city' ILIKE 'Kraków'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '1745 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '31-232'
        AND address -> 'city' ILIKE 'Kraków'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        5 AS Flag,
        '2015 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '21-109'
        AND address -> 'city' ILIKE 'Krasne'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '215 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '32-433'
        AND address -> 'city' ILIKE 'Lubień'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '734 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '05-270'
        AND address -> 'city' ILIKE 'Marki'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '96 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '32-085'
        AND address -> 'city' ILIKE 'Modlnica'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '1608 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '19-100'
        AND address -> 'city' ILIKE 'Mońki'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '839 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '58-262'
        AND address -> 'city' ILIKE 'Ostroszowice'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '879 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '05-500'
        AND address -> 'city' ILIKE 'Piaseczno'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '993 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '05-820'
        AND address -> 'city' ILIKE 'Piastów'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '778 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '41-940'
        AND address -> 'city' ILIKE 'Piekary Śląskie'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '1229 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '64-234'
        AND address -> 'city' ILIKE 'Przemęt'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '929 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '32-050'
        AND address -> 'city' ILIKE 'Skawina'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '1109 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '76-200'
        AND address -> 'city' ILIKE 'Słupsk'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '273 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '87-100'
        AND address -> 'city' ILIKE 'Toruń'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '1503 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '99-210'
        AND address -> 'city' ILIKE 'Uniejów'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '709 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '00-849'
        AND address -> 'city' ILIKE 'Warszawa'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '1743 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '01-315'
        AND address -> 'city' ILIKE 'Warszawa'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '1471 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '02-366'
        AND address -> 'city' ILIKE 'Warszawa'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '1502 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '02-513'
        AND address -> 'city' ILIKE 'Warszawa'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '398 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '02-549'
        AND address -> 'city' ILIKE 'Warszawa'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '1750 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '02-781'
        AND address -> 'city' ILIKE 'Warszawa'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '1097 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '03-133'
        AND address -> 'city' ILIKE 'Warszawa'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '1817 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '58-300'
        AND address -> 'city' ILIKE 'Wałbrzych'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '1586 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '66-001'
        AND address -> 'city' ILIKE 'Zawada'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '1639 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '77-400'
        AND address -> 'city' ILIKE 'Złotów'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '1944 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '90-336'
        AND address -> 'city' ILIKE 'Łódź'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '38 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '91-120'
        AND address -> 'city' ILIKE 'Łódź'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
UNION ALL
(
    SELECT 
        1 AS Flag,
        '1412 ' AS VecPos,
        address,
        ST_Y(ST_Centroid(centroid)) AS lat,
        ST_X(ST_Centroid(centroid)) AS lon
    FROM 
        placex
    WHERE 
        address -> 'postcode' ILIKE '91-347'
        AND address -> 'city' ILIKE 'Łódź'
        AND address -> 'housenumber' IS NOT NULL AND address -> 'housenumber' != ''
    ORDER BY RANDOM() 
    LIMIT 1
)
