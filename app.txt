# Załaduj potrzebne biblioteki
library(ggplot2)
library(reshape2)

# Załóżmy, że trójkąt Paid (6) jest zapisany w dataframe 'paid_triangle'
# Kolumny to lata rozwoju, a wiersze to kolejne lata (np. 1991, 1992, ..., 2024)
head(paid_triangle)

# Krok 2: Ekstrakcja danych przed 2008 rokiem
pre_2008 <- paid_triangle[paid_triangle$Year < 2008, ]

# Krok 3: Analiza trendów sprzed 2008 roku
pre_2008_increments <- diff(as.matrix(pre_2008), lag = 1)

# Krok 4: Ekstrapolacja trendów na lata po 2008 roku
model <- lm(pre_2008_increments ~ rownames(pre_2008))
predicted_increments <- predict(model, newdata = data.frame(rownames(paid_triangle[paid_triangle$Year >= 2008, ])))

# Zastosowanie prognozowanych wartości do lat po 2008 roku
predicted_triangle <- rbind(pre_2008, predicted_increments)

# Krok 5: Porównanie alternatywnego trójkąta z rzeczywistymi danymi
post_2008_real <- paid_triangle[paid_triangle$Year >= 2008, ]
differences <- post_2008_real - predicted_increments

# Wizualizacja różnic
plot(differences, main = "Różnice między prognozowanymi a rzeczywistymi wartościami po 2008 roku")

# Krok 6: Analiza wyników i wnioski
summary(differences)
